<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Add Products | E-COMMERCE WEBSITE BY EDYODA</title>
    <!-- favicon -->
    <link rel="icon" href="https://yt3.ggpht.com/a/AGF-l78km1YyNXmF0r3-0CycCA0HLA_i6zYn_8NZEg=s900-c-k-c0xffffffff-no-rj-mo" type="image/gif" sizes="16x16">
    <!-- header links -->
    <script src="https://kit.fontawesome.com/4a3b1f73a2.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
    <!-- slider links -->
    <script src="js/jQuery3.4.1.js"></script>
    <link rel="stylesheet" href="css/header2.css">
    <style>
        /* General Styles */
        body {
            font-family: 'Lato', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        h1, h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }

        /* Form Styles */
        .product-form-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 40px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input, 
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Lato', sans-serif;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .spec-container {
            margin-bottom: 10px;
        }

        .spec-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .spec-row input {
            flex: 1;
        }

        .spec-row button {
            width: 40px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .bulk-pricing-container {
            margin-bottom: 10px;
        }

        .bulk-pricing-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .bulk-pricing-row input {
            flex: 1;
        }

        .bulk-pricing-row button {
            width: 40px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .add-btn {
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .submit-btn {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
        }

        .submit-btn:hover {
            background-color: #0069d9;
        }

        /* Product Cards Styling */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 30px;
        }

        .product-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .product-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
        }

        .product-info {
            padding: 15px;
        }

        .product-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .company-name {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .product-price {
            font-weight: bold;
            color: #e63946;
            font-size: 16px;
        }
        
        .min-order {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        
        .in-stock {
            font-size: 12px;
            color: #28a745;
            margin-top: 5px;
        }

        /* Edit and Delete buttons */
        .card-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .edit-btn, .delete-btn {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .edit-btn {
            background-color: #ffc107;
            color: #212529;
        }

        .delete-btn {
            background-color: #dc3545;
            color: white;
        }

        /* Image Upload Styles */
        .image-upload-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            border: 2px dashed #ddd;
            padding: 20px;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

        .image-preview {
            width: 200px;
            height: 200px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            overflow: hidden;
            position: relative;
            border-radius: 5px;
        }

        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .file-input-container {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-input-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            cursor: pointer;
            display: inline-block;
        }

        .file-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .image-buttons {
            display: flex;
            gap: 10px;
        }

        .remove-image-btn {
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            cursor: pointer;
        }

        .or-separator {
            display: flex;
            align-items: center;
            text-align: center;
            color: #666;
            margin: 10px 0;
        }

        .or-separator::before,
        .or-separator::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid #ddd;
        }

        .or-separator::before {
            margin-right: 10px;
        }

        .or-separator::after {
            margin-left: 10px;
        }
    </style>
</head>

<body>
    <!-- HEADER -->
    <div id="1">
        <header>
            <section>
                <!-- MAIN CONTAINER -->
                <div id="container">
                    <!-- SHOP NAME -->
                    <div id="shopName"><a href="index2.html"><img src="img/logo.jpg" alt=""></a></div>

                    <!-- COLLECTIONS ON WEBSITE -->
                    <div id="collection">
                        <div id="clothing"><a href="clothing.html"> CLOTHING </a></div>
                        <div id="accessories"><a href="accessories.html"> ACCESSORIES </a></div>
                    </div>

                    <!-- SEARCH SECTION -->
                    <div id="search">
                        <i class="fas fa-search search"></i>
                        <input type="text" id="input" name="searchBox" placeholder="Search for wholesale items">
                    </div>

                    <!-- USER SECTION (CART AND USER ICON) -->
                    <div id="user">
                           
                        <a id="usrbtn" href="profile.html"> <img style="width: 50px;" src="img/profile.webp" alt=""></a>
                    </div>
                </div>
            </section>
        </header>
    </div>

    <!-- CONTENT SECTION -->
    <div class="container">
        <h1>Add New Products</h1>
        
        <!-- Product Form -->
        <div class="product-form-container">
            <h2>Product Information</h2>
            <form id="productForm">
                <div class="form-group">
                    <label for="productName">Product Name</label>
                    <input type="text" id="productName" required placeholder="e.g. Cotton T-Shirts (Bulk Pack)">
                </div>
                
                <div class="form-group">
                    <label for="companyName">Company Name</label>
                    <input type="text" id="companyName" required placeholder="e.g. TextilePro">
                </div>
                
                <div class="form-group">
                    <label for="productPrice">Price (per unit)</label>
                    <input type="text" id="productPrice" required placeholder="e.g. 300Rs per unit">
                </div>
                
                <div class="form-group">
                    <label for="minOrder">Minimum Order</label>
                    <input type="number" id="minOrder" required placeholder="e.g. 50">
                </div>
                
                <div class="form-group">
                    <label for="inStock">In Stock Quantity</label>
                    <input type="number" id="inStock" required placeholder="e.g. 1000">
                </div>
                
                <div class="form-group">
                    <label>Product Image</label>
                    <div class="image-upload-container">
                        <div class="image-preview" id="imagePreview">
                            <span>No Image Selected</span>
                        </div>
                        <div class="image-buttons">
                            <div class="file-input-container">
                                <span class="file-input-button">Choose File</span>
                                <input type="file" id="imageFile" class="file-input" accept="image/*">
                            </div>
                            <button type="button" id="removeImageBtn" class="remove-image-btn" style="display: none;">Remove</button>
                        </div>
                    </div>
                    <div class="or-separator">OR</div>
                    <input type="text" id="imageUrl" placeholder="Enter Image URL (e.g. img/tshirt.webp)">
                </div>
                
                <div class="form-group">
                    <label for="productDescription">Product Description</label>
                    <textarea id="productDescription" required placeholder="Detailed description of the product..."></textarea>
                </div>
                
                <!-- Specifications -->
                <div class="form-group">
                    <label>Specifications</label>
                    <div id="specContainer">
                        <div class="spec-row">
                            <input type="text" class="spec-input" placeholder="e.g. Material: 100% Combed Cotton, 180 GSM">
                            <button type="button" class="remove-spec-btn" onclick="removeSpec(this)">-</button>
                        </div>
                    </div>
                    <button type="button" class="add-btn" onclick="addSpec()">Add Specification</button>
                </div>
                
                <!-- Bulk Pricing -->
                <div class="form-group">
                    <label>Bulk Pricing</label>
                    <div id="bulkPricingContainer">
                        <div class="bulk-pricing-row">
                            <input type="text" class="quantity-input" placeholder="Quantity (e.g. 50-99)">
                            <input type="text" class="price-input" placeholder="Price (e.g. 300Rs)">
                            <button type="button" class="remove-pricing-btn" onclick="removePricing(this)">-</button>
                        </div>
                    </div>
                    <button type="button" class="add-btn" onclick="addBulkPricing()">Add Bulk Pricing Tier</button>
                </div>
                
                <button type="submit" class="submit-btn">Add Product</button>
            </form>
        </div>
        
        <!-- Products Grid -->
        <h2>Your Products</h2>
        <div class="products-grid" id="productsGrid">
            <!-- Product cards will be inserted here -->
        </div>
    </div>

    <script>
        // Initialize products array from localStorage or create empty array
        let products = JSON.parse(localStorage.getItem('customProducts')) || [];
        let editingProductId = null;
        let uploadedImage = null;

        // Function to generate a unique ID
        function generateId() {
            return Date.now() + Math.floor(Math.random() * 1000);
        }

        // Function to add a new specification field
        function addSpec() {
            const specContainer = document.getElementById('specContainer');
            const specRow = document.createElement('div');
            specRow.className = 'spec-row';
            specRow.innerHTML = `
                <input type="text" class="spec-input" placeholder="e.g. Material: 100% Combed Cotton, 180 GSM">
                <button type="button" class="remove-spec-btn" onclick="removeSpec(this)">-</button>
            `;
            specContainer.appendChild(specRow);
        }

        // Function to remove a specification field
        function removeSpec(button) {
            const specRow = button.parentElement;
            if (document.querySelectorAll('.spec-row').length > 1) {
                specRow.remove();
            } else {
                alert('At least one specification is required');
            }
        }

        // Function to add a new bulk pricing field
        function addBulkPricing() {
            const bulkPricingContainer = document.getElementById('bulkPricingContainer');
            const bulkPricingRow = document.createElement('div');
            bulkPricingRow.className = 'bulk-pricing-row';
            bulkPricingRow.innerHTML = `
                <input type="text" class="quantity-input" placeholder="Quantity (e.g. 50-99)">
                <input type="text" class="price-input" placeholder="Price (e.g. 300Rs)">
                <button type="button" class="remove-pricing-btn" onclick="removePricing(this)">-</button>
            `;
            bulkPricingContainer.appendChild(bulkPricingRow);
        }

        // Function to remove a bulk pricing field
        function removePricing(button) {
            const pricingRow = button.parentElement;
            if (document.querySelectorAll('.bulk-pricing-row').length > 1) {
                pricingRow.remove();
            } else {
                alert('At least one bulk pricing tier is required');
            }
        }

        // Image preview functionality
        document.getElementById('imageFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                uploadedImage = event.target.result;
                const preview = document.getElementById('imagePreview');
                preview.innerHTML = `<img src="${uploadedImage}" alt="Product Preview">`;
                document.getElementById('removeImageBtn').style.display = 'block';
                document.getElementById('imageUrl').value = ''; // Clear URL input
            };
            
            reader.readAsDataURL(file);
        });
        
        // Remove image functionality
        document.getElementById('removeImageBtn').addEventListener('click', function() {
            uploadedImage = null;
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = `<span>No Image Selected</span>`;
            document.getElementById('removeImageBtn').style.display = 'none';
            document.getElementById('imageFile').value = ''; // Clear file input
        });
        
        // Function to handle form submission
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const productName = document.getElementById('productName').value;
            const companyName = document.getElementById('companyName').value;
            const productPrice = document.getElementById('productPrice').value;
            const minOrder = parseInt(document.getElementById('minOrder').value);
            const inStock = parseInt(document.getElementById('inStock').value);
            
            // Get image source (either uploaded image or URL)
            let imageSource = 'img/placeholder.webp'; // Default placeholder
            if (uploadedImage) {
                imageSource = uploadedImage;
            } else if (document.getElementById('imageUrl').value.trim() !== '') {
                imageSource = document.getElementById('imageUrl').value.trim();
            }
            
            const productDescription = document.getElementById('productDescription').value;
            
            // Get specifications
            const specInputs = document.querySelectorAll('.spec-input');
            const specs = [];
            specInputs.forEach(input => {
                if (input.value.trim() !== '') {
                    specs.push(input.value.trim());
                }
            });
            
            // Get bulk pricing
            const quantityInputs = document.querySelectorAll('.quantity-input');
            const priceInputs = document.querySelectorAll('.price-input');
            const bulkPricing = [];
            
            for (let i = 0; i < quantityInputs.length; i++) {
                if (quantityInputs[i].value.trim() !== '' && priceInputs[i].value.trim() !== '') {
                    bulkPricing.push({
                        quantity: quantityInputs[i].value.trim(),
                        price: priceInputs[i].value.trim()
                    });
                }
            }
            
            // Create product object
            const product = {
                id: editingProductId || generateId(),
                name: productName,
                company: companyName,
                price: productPrice,
                minOrder: `Minimum order: ${minOrder} pieces`,
                inStock: inStock,
                image: imageSource,
                description: productDescription,
                specs: specs,
                bulkPricing: bulkPricing,
                isBase64Image: imageSource.startsWith('data:image/') // Flag to identify uploaded images
            };
            
            // Add product to array or update existing product
            if (editingProductId) {
                const index = products.findIndex(p => p.id === editingProductId);
                if (index !== -1) {
                    products[index] = product;
                }
                editingProductId = null; // Reset editing state
            } else {
                products.push(product);
            }
            
            // Save to localStorage
            localStorage.setItem('customProducts', JSON.stringify(products));
            
            // Update UI
            generateProductCards();
            
            // Reset form
            this.reset();
            
            // Reset image preview
            uploadedImage = null;
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = `<span>No Image Selected</span>`;
            document.getElementById('removeImageBtn').style.display = 'none';
            
            // Reset specification and bulk pricing fields
            document.getElementById('specContainer').innerHTML = `
                <div class="spec-row">
                    <input type="text" class="spec-input" placeholder="e.g. Material: 100% Combed Cotton, 180 GSM">
                    <button type="button" class="remove-spec-btn" onclick="removeSpec(this)">-</button>
                </div>
            `;
            document.getElementById('bulkPricingContainer').innerHTML = `
                <div class="bulk-pricing-row">
                    <input type="text" class="quantity-input" placeholder="Quantity (e.g. 50-99)">
                    <input type="text" class="price-input" placeholder="Price (e.g. 300Rs)">
                    <button type="button" class="remove-pricing-btn" onclick="removePricing(this)">-</button>
                </div>
            `;
            
            // Reset submit button text
            document.querySelector('.submit-btn').textContent = 'Add Product';
            
            // Show confirmation message
            alert('Product saved successfully!');
        });

        // Function to generate product cards
        function generateProductCards() {
            const productsGrid = document.getElementById('productsGrid');
            productsGrid.innerHTML = '';
            
            if (products.length === 0) {
                productsGrid.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">No products added yet. Add a product using the form above.</p>';
                return;
            }
            
            products.forEach(product => {
                const card = document.createElement('div');
                card.className = 'product-card';
                
                let imageHtml;
                if (product.isBase64Image) {
                    // For uploaded images stored as base64
                    imageHtml = `<img src="${product.image}" alt="${product.name}" style="width:100%; height:100%; object-fit:cover;">`;
                } else if (product.image === 'img/placeholder.webp') {
                    // For placeholder
                    imageHtml = '<span>No Image Available</span>';
                } else {
                    // For URL-based images
                    imageHtml = `<img src="${product.image}" alt="${product.name}" style="width:100%; height:100%; object-fit:cover;">`;
                }
                
                card.innerHTML = `
                    <div class="product-image">${imageHtml}</div>
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <div class="company-name">${product.company}</div>
                        <div class="product-price">${product.price}</div>
                        <div class="min-order">${product.minOrder}</div>
                        <div class="in-stock">In stock: ${product.inStock} units</div>
                        <div class="card-actions">
                            <button class="edit-btn" onclick="editProduct(${product.id})">Edit</button>
                            <button class="delete-btn" onclick="deleteProduct(${product.id})">Delete</button>
                        </div>
                    </div>
                `;
                
                productsGrid.appendChild(card);
            });
        }

        // Function to edit a product
        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;
            
            // Set form values
            document.getElementById('productName').value = product.name;
            document.getElementById('companyName').value = product.company;
            document.getElementById('productPrice').value = product.price;
            
            // Extract numeric value from minOrder string
            const minOrderMatch = product.minOrder.match(/Minimum order: (\d+)/);
            document.getElementById('minOrder').value = minOrderMatch ? minOrderMatch[1] : '';
            
            document.getElementById('inStock').value = product.inStock;
            
            // Set image preview
            const preview = document.getElementById('imagePreview');
            if (product.isBase64Image) {
                uploadedImage = product.image;
                preview.innerHTML = `<img src="${product.image}" alt="Product Preview">`;
                document.getElementById('removeImageBtn').style.display = 'block';
                document.getElementById('imageUrl').value = '';
            } else if (product.image !== 'img/placeholder.webp') {
                preview.innerHTML = `<span>Using URL Image</span>`;
                document.getElementById('imageUrl').value = product.image;
                document.getElementById('removeImageBtn').style.display = 'none';
                uploadedImage = null;
            } else {
                preview.innerHTML = `<span>No Image Selected</span>`;
                document.getElementById('imageUrl').value = '';
                document.getElementById('removeImageBtn').style.display = 'none';
                uploadedImage = null;
            }
            
            document.getElementById('productDescription').value = product.description;
            
            // Set specifications
            const specContainer = document.getElementById('specContainer');
            specContainer.innerHTML = '';
            product.specs.forEach(spec => {
                const specRow = document.createElement('div');
                specRow.className = 'spec-row';
                specRow.innerHTML = `
                    <input type="text" class="spec-input" value="${spec}">
                    <button type="button" class="remove-spec-btn" onclick="removeSpec(this)">-</button>
                `;
                specContainer.appendChild(specRow);
            });
            
            // Set bulk pricing
            const bulkPricingContainer = document.getElementById('bulkPricingContainer');
            bulkPricingContainer.innerHTML = '';
            product.bulkPricing.forEach(pricing => {
                const pricingRow = document.createElement('div');
                pricingRow.className = 'bulk-pricing-row';
                pricingRow.innerHTML = `
                    <input type="text" class="quantity-input" value="${pricing.quantity}">
                    <input type="text" class="price-input" value="${pricing.price}">
                    <button type="button" class="remove-pricing-btn" onclick="removePricing(this)">-</button>
                `;
                bulkPricingContainer.appendChild(pricingRow);
            });
            
            // Set editing state
            editingProductId = id;
            
            // Scroll to form
            document.querySelector('.product-form-container').scrollIntoView({ behavior: 'smooth' });
            
            // Update submit button text
            document.querySelector('.submit-btn').textContent = 'Update Product';
        }

        // Function to delete a product
        function deleteProduct(id) {
            if (confirm('Are you sure you want to delete this product?')) {
                products = products.filter(p => p.id !== id);
                localStorage.setItem('customProducts', JSON.stringify(products));
                generateProductCards();
            }
        }

        // Initialize the page
        window.onload = function() {
            generateProductCards();
        };
    </script>
</body>
</html>